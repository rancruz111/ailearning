<!DOCTYPE html>
<html>
<head>
    <title>Communication Training AI Interface</title>
</head>
<body>
    <div id="response">Starting up...</div>
    <script>
        // Create a more reliable way to communicate
        class CommunicationInterface {
            constructor() {
                this.ready = false;
                this.initializeInterface();
            }

            initializeInterface() {
                // Announce ourselves
                console.log("Initializing communication interface...");
                
                // Set up our handler
                this.handleLearnerInput = async (input, scenario) => {
                    console.log("Processing input:", input);
                    try {
                        return "TEST RESPONSE: You said: '" + input + "' regarding scenario: '" + scenario + "'";
                    } catch (error) {
                        console.error("Error processing input:", error);
                        throw error;
                    }
                };

                // Make ourselves available globally
                window.communicationInterface = this;
                window.handleLearnerInput = this.handleLearnerInput;
                
                // Signal we're ready
                this.ready = true;
                console.log("Interface fully initialized!");
                document.getElementById('response').innerText = 'Communication system ready!';
            }

            isReady() {
                return this.ready;
            }
        }

        // Create our interface when the page loads
        window.onload = function() {
            new CommunicationInterface();
        };
    </script>
</body>
</html>
