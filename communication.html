<!DOCTYPE html>
<html>
<head>
    <title>Communication Training AI Interface</title>
</head>
<body>
    <div id="response">System starting...</div>
    <script>
        // First, make our functions available to the parent window (Storyline)
        function initializeSystem() {
            console.log('Initializing communication system...');
            
            // Create our handler function
            function handleInput(input, scenario) {
                console.log('Processing input:', input);
                document.getElementById('response').innerText = 
                    'Processing: ' + input;
                
                return Promise.resolve('Test response: You said "' + input + 
                    '" about the deadline scenario.');
            }
            
            // Make everything available to the parent window (Storyline)
            window.parent.systemReady = true;
            window.parent.handleLearnerInput = handleInput;
            
            // Also keep local copies
            window.systemReady = true;
            window.handleLearnerInput = handleInput;
            
            document.getElementById('response').innerText = 
                'System ready for input!';
            console.log('System fully initialized');
        }

        // Initialize as soon as possible
        initializeSystem();
        
        // Also initialize when the page loads
        window.onload = initializeSystem;
    </script>
</body>
</html>
